@namespace("ch.admin.bit.jeap.s3.malware.scanned")
protocol S3ObjectMalwareScannedProtocol {
  import idl "DomainEventBaseTypes.avdl";

  enum S3ObjectMalwareScanResult {
    // No potential threat associated with the scanned object has been detected.
    NO_THREATS_FOUND,
    // A potential threat associated with the scanned object has been detected.
    THREATS_FOUND,
    // There are a few reasons why Malware Protection for S3 will skip a scan. Potential reasons include
    // password-protected file, Malware Protection for S3 quotas, and support for certain S3 features may be unavailable.
    UNSUPPORTED,
    // The object is not accessible to Malware Protection for S3 due to permission issues.
    ACCESS_DENIED,
    // The malware scan has failed and did not complete successfully due to an internal error in the malware scanner.
    FAILED
  }

  record S3ObjectReference {
    string type = "s3object";
    string bucketName;
    string objectKey;
    string? objectVersionId = null;
  }

  record S3ObjectMalwareScannedReferences {
    S3ObjectReference s3ObjectReference;
  }

  record S3ObjectMalwareScannedPayload {
    S3ObjectMalwareScanResult scanResult;
  }

  record S3ObjectMalwareScannedEvent {
    ch.admin.bit.jeap.domainevent.avro.AvroDomainEventIdentity identity;
    ch.admin.bit.jeap.domainevent.avro.AvroDomainEventType type;
    ch.admin.bit.jeap.domainevent.avro.AvroDomainEventPublisher publisher;
    S3ObjectMalwareScannedReferences references;
    S3ObjectMalwareScannedPayload payload;
    string domainEventVersion;
    string? processId = null;
  }
}
